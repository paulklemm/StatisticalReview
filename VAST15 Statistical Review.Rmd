---
title: "VAST15 Statistical Review"
author: "Paul Klemm"
date: "19. November 2015"
output: 
  html_document:
    toc: true
---

This notebooks conducts a statistical analysis of hypotheses derived through the VAST'15 publication [3D Regression Heat Map Analysis of Population Study Data](http://dx.doi.org/10.1109/tvcg.2015.2468291).

```{r}
ship <- read.csv('/Users/paul/Tresors/regresson-heatmap/data/breast_fat_imageonly_labels_parenchym_mean.csv')
```

## ANOVA of `Parenchyma Tissue` and `Kidney Disorder`

```{r}
library(gplots)
plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$Disease_Kidney_Disorder, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by disease kidney disorder", xlab="kidney disorder", ylab="parenchyma tissue")

means<- round(tapply(ship$Segmentation_ParenchymToVolume, ship$Disease_Kidney_Disorder, mean), digits=2)
means

boxplot(ship$Segmentation_ParenchymToVolume ~ ship$Disease_Kidney_Disorder, main="parenchyma tissue by disease kidney disorder (mean is black dot)", xlab="kidney disorder", ylab="parenchyma", col=rainbow(7))
```

Remove Subjects with error or no value for `kidney disorder`.

```{r}
library(dplyr)
# Analyze only for subjects with valid back pain indicators
#ship_valid_kidney <- filter(.data = ship, as.integer(Disease_Kidney_Disorder) < 90000)
#ship_valid_kidney <- ship %>% filter(Disease_Kidney_Disorder == "Nein 99998 - Fehler, Daten nicht mehr erhebbar") %>% droplevels()
ship_valid_kidney <- filter(ship, !(as.character(Disease_Kidney_Disorder)%in% c("99998 - Fehler, Daten nicht mehr erhebbar", "")))
ship_valid_kidney <- droplevels(ship_valid_kidney)

plotmeans(ship_valid_kidney$Segmentation_ParenchymToVolume ~ ship_valid_kidney$Disease_Kidney_Disorder, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by disease kidney disorder", xlab="kidney disorder", ylab="parenchyma tissue")

boxplot(ship_valid_kidney$Segmentation_ParenchymToVolume ~ ship_valid_kidney$Disease_Kidney_Disorder, main="parenchyma tissue by disease kidney disorder (mean is black dot)", xlab="kidney disorder", ylab="parenchyma", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~Disease_Kidney_Disorder, data = ship_valid_kidney))
```

The ANOVA comprises of a fairly low F value with a p value of 0.103. Therefore, by the standard of a p value of 0.05, the alternative hypothesis has to be rejected.


## ANOVA of `Parenchyma Tissue` and `Diabetes`

```{r}
plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$Diabetes, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by diabetes", xlab="diabetes", ylab="parenchyma tissue")

boxplot(ship$Segmentation_ParenchymToVolume ~ ship$Diabetes, main="parenchyma tissue by diabetes (mean is black dot)", xlab="diabetes", ylab="parenchyma", col=rainbow(7))
```

```{r}
ship_valid_diabetes <- filter(ship, !(as.character(Diabetes)%in% c("99998 - Fehler, Daten nicht mehr erhebbar", "")))
ship_valid_diabetes <- droplevels(ship_valid_diabetes)

plotmeans(ship_valid_diabetes$Segmentation_ParenchymToVolume ~ ship_valid_diabetes$Diabetes, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by diabetes", xlab="diabetes", ylab="parenchyma tissue")

boxplot(ship_valid_diabetes$Segmentation_ParenchymToVolume ~ ship_valid_diabetes$Diabetes, main="parenchyma tissue by diabetes (mean is black dot)", xlab="diabetes", ylab="parenchyma", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~Diabetes, data = ship_valid_diabetes))
```

Diabetes shows a significant correlation with parenchyma tissue with an F value o 12.8 and a p value of 0.0003.

## ANOVA of `Parenchyma Tissue` and `Hormone Replacement Therapy`

At first, visualize the means and draw the box plots.

```{r}
plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$Women_Hormone_Replacement_Therapy, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by hormone replacement therapy", xlab="hormone replacement therapy", ylab="parenchyma tissue")

boxplot(ship$Segmentation_ParenchymToVolume ~ ship$Women_Hormone_Replacement_Therapy, main="parenchyma tissue by hormone replacement therapy (mean is black dot)", xlab="hormone replacement therapy", ylab="parenchyma tissue", col=rainbow(7))
```

As before, remove the error dimensions and conduct the ANOVA.

```{r}
ship_valid_hormone <- filter(ship, !(as.character(Women_Hormone_Replacement_Therapy)%in% c("99998 - Fehler, Daten nicht mehr erhebbar", "")))
ship_valid_hormone <- droplevels(ship_valid_hormone)

plotmeans(ship_valid_hormone$Segmentation_ParenchymToVolume ~ ship_valid_hormone$Women_Hormone_Replacement_Therapy, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by hormone replacement therapy", xlab="hormone replacement therapy", ylab="parenchyma tissue")

boxplot(ship_valid_hormone$Segmentation_ParenchymToVolume ~ ship_valid_hormone$Women_Hormone_Replacement_Therapy, main="parenchyma tissue by hormone replacement therapy (mean is black dot)", xlab="hormone replacement therapy", ylab="parenchyma tissue", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~Women_Hormone_Replacement_Therapy, data = ship_valid_hormone))
```

## ANOVA for `Parenchyma Tissue` and `Mammography Finding Classification`

The `mammography finding classification` feature is categorical and defined individual for both breasts. Therfore, the ANOVA is conducted for both the left and the right feature. At first, plot both features.

```{r}
plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$Mammography_Left_BI_RADS, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Left)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue")
boxplot(ship$Segmentation_ParenchymToVolume ~ ship$Mammography_Left_BI_RADS, main="parenchyma tissue by mammography finding classification (Left) (mean is black dot)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue", col=rainbow(7))

plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$Mammography_Right_BI_RADS, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Right)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue")
boxplot(ship$Segmentation_ParenchymToVolume ~ ship$Mammography_Right_BI_RADS, main="parenchyma tissue by mammography finding classification (Right) (mean is black dot)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue", col=rainbow(7))
```

Now remove the invalid dimensions from both features and conduct the analysis.

```{r}
ship_valid_mammography <- filter(ship, !(as.character(Mammography_Right_BI_RADS)%in% c("99998 - Fehler, Daten nicht mehr erhebbar", "")))
ship_valid_mammography <- droplevels(ship_valid_mammography)

plotmeans(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Left_BI_RADS, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Left)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue")
boxplot(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Left_BI_RADS, main="parenchyma tissue by mammography finding classification (Left) (mean is black dot)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue", col=rainbow(7))

plotmeans(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Right_BI_RADS, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Right)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue")
boxplot(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Right_BI_RADS, main="parenchyma tissue by mammography finding classification (Right) (mean is black dot)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~Mammography_Left_BI_RADS, data = ship_valid_mammography))
summary(aov(formula = Segmentation_ParenchymToVolume~Mammography_Right_BI_RADS, data = ship_valid_mammography))
```

## ANOVA for `Parenchyma Tissue` and `Breast Lesions`

This is once again a categorical target feature which is derived for the left and right breast separately.

```{r}
plotmeans(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Left_Lesion, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Left)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue")
boxplot(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Left_Lesion, main="parenchyma tissue by mammography finding classification (Left) (mean is black dot)", xlab="mammography finding classification (Left)", ylab="parenchyma tissue", col=rainbow(7))

plotmeans(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Right_Lesion, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by mammography finding classification (Right)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue")
boxplot(ship_valid_mammography$Segmentation_ParenchymToVolume ~ ship_valid_mammography$Mammography_Right_Lesion, main="parenchyma tissue by mammography finding classification (Right) (mean is black dot)", xlab="mammography finding classification (Right)", ylab="parenchyma tissue", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~Mammography_Left_Lesion, data = ship_valid_mammography))
summary(aov(formula = Segmentation_ParenchymToVolume~Mammography_Right_Lesion, data = ship_valid_mammography))
```

The ANOVA rejects the alternative hypothesis of a correlation between `parenchyma tissue` and `breast lesion`.

## ANOVA between `Parenchyma Tissue` and `Spiral Contraception`

```{r}
plotmeans(ship$Segmentation_ParenchymToVolume ~ ship$MAMMA_Anamnesis_Contraception_Spiral, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by spiral contraception", xlab="spiral contraception", ylab="parenchyma tissue")
boxplot(ship$Segmentation_ParenchymToVolume ~ ship$MAMMA_Anamnesis_Contraception_Spiral, main="parenchyma tissue by spiral contraception", xlab="spiral contraception", ylab="parenchyma tissue", col=rainbow(7))
```

Now remove the subjects without a valid contraception entry.

```{r}
ship_valid_contraception <- filter(ship, !(as.character(MAMMA_Anamnesis_Contraception_Spiral)%in% c("99998 - Fehler, Daten nicht mehr erhebbar", "")))
ship_valid_contraception <- droplevels(ship_valid_contraception)

plotmeans(ship_valid_contraception$Segmentation_ParenchymToVolume ~ ship_valid_contraception$MAMMA_Anamnesis_Contraception_Spiral, digits=2, ccol="red", mean.labels=T, main="parenchyma tissue by spiral contraception", xlab="spiral contraception", ylab="parenchyma tissue")
boxplot(ship_valid_contraception$Segmentation_ParenchymToVolume ~ ship_valid_contraception$MAMMA_Anamnesis_Contraception_Spiral, main="parenchyma tissue by spiral contraception", xlab="spiral contraception", ylab="parenchyma tissue", col=rainbow(7))

summary(aov(formula = Segmentation_ParenchymToVolume~MAMMA_Anamnesis_Contraception_Spiral, data = ship_valid_contraception))
```