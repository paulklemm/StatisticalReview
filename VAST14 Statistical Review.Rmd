---
title: "VAST14 Statistical Review"
author: "Paul Klemm"
date: "18. November 2015"
output: 
  html_document:
    toc: true
---

This notebooks conducts a statistical analysis of hypotheses derived through the VAST'14 publication [Interactive Visual Analysis of Image-Centric Cohort Study Data](http://dx.doi.org/10.1109/tvcg.2014.2346591).

Sources are:

- [https://stats.stackexchange.com/questions/108007/correlations-with-categorical-variables](https://stats.stackexchange.com/questions/108007/correlations-with-categorical-variables)
- [http://www.analyticsforfun.com/2014/06/performing-anova-test-in-r-results-and.html](http://www.analyticsforfun.com/2014/06/performing-anova-test-in-r-results-and.html)
- [https://stats.stackexchange.com/questions/12398/how-to-interpret-f-and-p-value-in-anova](https://stats.stackexchange.com/questions/12398/how-to-interpret-f-and-p-value-in-anova)
- [https://stats.stackexchange.com/questions/147863/how-to-interpret-the-residual-colors-on-a-mosaic-plot](https://stats.stackexchange.com/questions/147863/how-to-interpret-the-residual-colors-on-a-mosaic-plot)
- Mosaic Plot Residual Shading [https://cran.r-project.org/web/packages/vcd/vignettes/residual-shadings.pdf](https://cran.r-project.org/web/packages/vcd/vignettes/residual-shadings.pdf)

## Setup

Load the data and only keep subjects with extracted centerlines. This is necessary to have a concurrent population with the paper.

```{r results='hide', message=FALSE}
library(gplots)
library(jsonlite)
library(dplyr)
library(vcd)
library(gridExtra)
```

```{r}
# Odds Ratio Function according to https://de.wikipedia.org/wiki/Quotenverh%C3%A4ltnis#Anwendung
calculate_odds <- function(contingency_table) {
  return ( ( contingency_table[1,1] * contingency_table[2,2] ) / ( contingency_table[1,2] * contingency_table[2,1] ) )
}
calculate_odds_inverse <- function(contingency_table) {
  return ( ( contingency_table[1,2] * contingency_table[2,1] ) / ( contingency_table[1,1] * contingency_table[2,2] ) )
}

# Get all subjects IDs with centerlines
centerlines <- list.files('/Users/paul/Sites/vis14/site/data/centerlines')
# Replace the centerlines to leave only the subject IDs
centerlines <- gsub(pattern = '_MESH_COR_ES.vtk', replacement = '', centerlines)
#'/Users/paul/Sites/vis14/site/data/ship-data/data/shipdata/s0-t0_correlations.json'
# Now read both SHIP cohorts and only keep the subjects with a centerline
ship_s2 <- read.csv('/Users/paul/Sites/vis14/site/data/ship-data/data/shipdata/SHIP_2013_174_D_S2_complete/SHIP_2013_174_D_S2_complete.csv')
ship_t0 <- read.csv('/Users/paul/Sites/vis14/site/data/ship-data/data/shipdata/SHIP_2013_174_D_T0_complete/SHIP_2013_174_D_T0_complete.csv')
# Rename dimension names
same_features <- fromJSON('same_features.json')
for (rename_feature in same_features) {
  names(ship_t0)[names(ship_t0)==rename_feature$name_t0] <- rename_feature$newName
  names(ship_s2)[names(ship_s2)==rename_feature$name_s2] <- rename_feature$newName
}
ship <- merge(ship_s2, ship_t0, all = TRUE)
# Only keep subjects with an extracted centerline (https://stackoverflow.com/questions/9860090/in-r-why-is-better-than-subset)
ship <- ship[ship$zz_nr %in% centerlines, ]
# Add BMI
ship <- mutate(ship, BMI = ship$Gewicht / ( (ship$Groesse / 100) * (ship$Groesse / 100) ) )
# Add Subjects Over 60
ship <- mutate(ship, AgeOver60 = ship$Age > 60)
ship <- mutate(ship, AgeOver70 = ship$Age > 70)
ship <- mutate(ship, AgeOver80 = ship$Age > 80)

# Filter Subjects above 60
ship_age <- filter(ship, Age > 60)
```

## ANOVA for `Back Pain` and `Age`.

At first, display the means between the groups.

**H_0** There is no difference in `Back Pain` regarding `Age`.

**H_1** The `Back Pain` groups are *not* equal w.r.t. `Age`.

```{r fig.width=10, fig.height=8}
par(mfrow=c(2,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
plotmeans(ship$Age ~ ship$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of Age by back pain")

boxplot(ship$Age ~ ship$Rueckenschmerz_3Monate, main="Back pain by age (mean is black dot)", xlab="back pain", ylab="age", col=rainbow(7))

plotmeans(ship_age$Age ~ ship_age$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of Age by back pain")

boxplot(ship_age$Age ~ ship_age$Rueckenschmerz_3Monate, main="Back pain by age (mean is black dot)", xlab="back pain", ylab="age", col=rainbow(7))

title(main = "Top: Age by Back Pain; Bottom: Subjects older than 60 years", outer=TRUE)
```

The few outliers may distort the analysis, therefore I remove them.
```{r fig.width=10, fig.height=8}
# Convert back pain to a factor variable
ship$Rueckenschmerz_3Monate <- as.factor(ship$Rueckenschmerz_3Monate)
ship_age$Rueckenschmerz_3Monate <- as.factor(ship_age$Rueckenschmerz_3Monate)
# Analyze only for subjects with valid back pain indicators
ship_valid_backpain <- filter(ship, !(as.character(Rueckenschmerz_3Monate)%in% c("99996", "99998", "99999")))
ship_age_valid_backpain <- filter(ship_age, !(as.character(Rueckenschmerz_3Monate)%in% c("99996", "99998", "99999")))
ship_valid_backpain <- droplevels(ship_valid_backpain)
ship_age_valid_backpain <- droplevels(ship_age_valid_backpain)
```

Apply the same plot again.

```{r fig.width=10, fig.height=8}
par(mfrow=c(2,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
plotmeans(ship_valid_backpain$Age ~ ship_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of Age by back pain")

boxplot(ship_valid_backpain$Age ~ ship_valid_backpain$Rueckenschmerz_3Monate, main="Back pain by age (mean is black dot)", xlab="back pain", ylab="age", col=rainbow(7))

plotmeans(ship_age_valid_backpain$Age ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of Age by back pain")

boxplot(ship_age_valid_backpain$Age ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, main="Back pain by age (mean is black dot)", xlab="back pain", ylab="age", col=rainbow(7))

title(main = "Top: Age by Back Pain; Bottom: Subjects older than 60 years", outer=TRUE)
```

Calculate the ANOVA for both data sets.

```{r fig.width=10, fig.height=8}
summary(aov(formula = Age~Rueckenschmerz_3Monate, data = ship))
summary(aov(formula = Age~Rueckenschmerz_3Monate, data = ship_valid_backpain))
summary(aov(formula = Age~Rueckenschmerz_3Monate, data = ship_age))
summary(aov(formula = Age~Rueckenschmerz_3Monate, data = ship_age_valid_backpain))
```

Neither of the features are suitable to confirm the alternative hypothesis. Help with the interpretation can be found here:

- [http://www.analyticsforfun.com/2014/06/performing-anova-test-in-r-results-and.html](http://www.analyticsforfun.com/2014/06/performing-anova-test-in-r-results-and.html)
- [https://stats.stackexchange.com/questions/12398/how-to-interpret-f-and-p-value-in-anova](https://stats.stackexchange.com/questions/12398/how-to-interpret-f-and-p-value-in-anova)

Now we further calculate the Odds Ratio for back pain and age over 60.

```{r}
# Create Tabs
tab_age_backpain_over60 <- xtabs(~Rueckenschmerz_3Monate + AgeOver60, data = ship_valid_backpain)
tab_age_backpain_over70 <- xtabs(~Rueckenschmerz_3Monate + AgeOver70, data = ship_valid_backpain)
tab_age_backpain_over80 <- xtabs(~Rueckenschmerz_3Monate + AgeOver80, data = ship_valid_backpain)
print(tab_age_backpain_over60)
print(tab_age_backpain_over70)
print(tab_age_backpain_over80)
# Calculate the inverse Odds ratio, since "false" is the first entry in the table
print(calculate_odds_inverse(tab_age_backpain_over60))
print(calculate_odds_inverse(tab_age_backpain_over70))
print(calculate_odds_inverse(tab_age_backpain_over80))
```

The Odds for having back pain is therefore nearly equal for subjects older or junger than 60 years and 70 years. The odds ratio drops for subjects older than 80 years, but this may be due to the rather low sample size of only `r tab_age_backpain_over80[1,2] + tab_age_backpain_over80[2,2]` subjects older than 80 years.

## ANOVA for `Back Pain` and `Body Fat`

At first, plot again the means as well as create the boxplots.

```{r fig.width=10, fig.height=8}
par(mfrow=c(2,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
plotmeans(ship_valid_backpain$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of body fat by back pain", xlab="back pain", ylab="body fat")

boxplot(ship_valid_backpain$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_valid_backpain$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

plotmeans(ship_age_valid_backpain$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of body fat by back pain", xlab="back pain", ylab="body fat")

boxplot(ship_age_valid_backpain$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

title(main = "Top: Age by Body Fat; Bottom: Subjects older than 60 years", outer=TRUE)
```

The boxplot shows that there are most likely error codes still in the `body fat` group, which are therefore removed.

```{r fig.width=10, fig.height=8}
ship_valid_backpain_bodyfat <- filter(.data = ship_valid_backpain, BIA_KOERPERFETT_KORR_IN_PROZ < 90000)

ship_age_valid_backpain_bodyfat <- filter(.data = ship_age_valid_backpain, BIA_KOERPERFETT_KORR_IN_PROZ < 90000)

par(mfrow=c(1,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
boxplot(ship_valid_backpain_bodyfat$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_valid_backpain_bodyfat$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

boxplot(ship_age_valid_backpain_bodyfat$BIA_KOERPERFETT_KORR_IN_PROZ ~ ship_age_valid_backpain_bodyfat$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

summary(aov(formula = BIA_KOERPERFETT_KORR_IN_PROZ~Rueckenschmerz_3Monate, data = ship_valid_backpain_bodyfat))

summary(aov(formula = BIA_KOERPERFETT_KORR_IN_PROZ~Rueckenschmerz_3Monate, data = ship_age_valid_backpain_bodyfat))
```

The p value is very low with a high F value, therefore we can accept the alternative hypothesis.

Now we look at the Odds ratios for subjects with high body fat percentages. The WHO does not depict clear cutoff values for obesity levels w.r.t. body fat percentage. Therefore, we use cutoff values from a peer reviewed clinical paper correlating obesity to cardiometabolic dysregulation and cardiovascular mortality.

- A. Romero-Corral, V. K. Somers, J. Sierra-Johnson, Y. Korenfeld, S. Boarin, J. Korinek, M. D. Jensen, G. Parati, F. Lopez-Jimenez. “Normal weight obesity: a risk factor for cardiometabolic dysregulation and cardiovascular mortality”, vol. 31, no. 6, pp. 737–746, 2010.

```{r}
# Calculate Odds Ratios for Males and Females
ship_valid_backpain_bodyfat <- mutate(ship_valid_backpain_bodyfat, FatPercenteageOver23 = BIA_KOERPERFETT_KORR_IN_PROZ > 23.15)
ship_valid_backpain_bodyfat <- mutate(ship_valid_backpain_bodyfat, FatPercenteageOver33 = BIA_KOERPERFETT_KORR_IN_PROZ > 33.3)
# SEX == 1 is Male and SEX == 2 is Female
tab_bodyfat_backpain_females <- xtabs(~Rueckenschmerz_3Monate + FatPercenteageOver33, data = filter(ship_valid_backpain_bodyfat, SEX == 2))
tab_bodyfat_backpain_males <- xtabs(~Rueckenschmerz_3Monate + FatPercenteageOver23, data = filter(ship_valid_backpain_bodyfat, SEX == 1))
print(tab_bodyfat_backpain_females)
print(tab_bodyfat_backpain_males)
# Calculate the inverse Odds ratio, since "false" is the first entry in the table
odds_bodyfat_backpain_females <- calculate_odds_inverse(tab_bodyfat_backpain_females)
odds_bodyfat_backpain_males <- calculate_odds_inverse(tab_bodyfat_backpain_males)
print(odds_bodyfat_backpain_females)
print(odds_bodyfat_backpain_males)
```

The odds for obese women to have back pain as oposed to non-obese women are `r odds_bodyfat_backpain_females`. For Men, this effect is even stronger, having an odds ratio of `r odds_bodyfat_backpain_males` to have back pain with obesity.


## ANOVA for `Back Pain` and `BMI`

To assess the BMI, display the histograms

```{r fig.width=10, fig.height=4}
par(mfrow=c(1,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
hist(ship$BMI)
hist(ship_age$BMI)
title(main = "Left: Histogram of BMI; Right: Subjects older than 60 years", outer=TRUE)
```

Plot the means as well as create the boxplots.

```{r fig.width=10, fig.height=8}
par(mfrow=c(2,2), oma=c(1,1,2,1), mar=c(2,2,2,2))
plotmeans(ship_valid_backpain$BMI ~ ship_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of BMI by back pain", xlab="back pain", ylab="BMI")

boxplot(ship_valid_backpain$BMI ~ ship_valid_backpain$Rueckenschmerz_3Monate, main="back pain by BMI (mean is black dot)", xlab="back pain", ylab="BMI", col=rainbow(7))

plotmeans(ship_age_valid_backpain$BMI ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of BMI by back pain", xlab="back pain", ylab="BMI")

boxplot(ship_age_valid_backpain$BMI ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, main="back pain by BMI (mean is black dot)", xlab="back pain", ylab="BMI", col=rainbow(7))

title(main = "Top: Age by BMI; Bottom: Subjects older than 60 years", outer=TRUE)

summary(aov(formula = BMI~Rueckenschmerz_3Monate, data = ship_valid_backpain))

summary(aov(formula = BMI~Rueckenschmerz_3Monate, data = ship_age_valid_backpain))
```

There is no correlation with `BMI` and `Back Pain` observable in the data. This is followed up with calculating the Odds Ratios of back pain with obese subjects according to the BMI.

```{r}
# Create Obesity BMI feature
ship_valid_backpain <- mutate(ship_valid_backpain, BMIObese = BMI >= 30)

# SEX == 1 is Male and SEX == 2 is Female
tab_bmi_backpain <- xtabs(~Rueckenschmerz_3Monate + BMIObese, data = ship_valid_backpain)
print(tab_bmi_backpain)
# Calculate the inverse Odds ratio, since "false" is the first entry in the table
odds_bmi_backpain <- calculate_odds_inverse(tab_bmi_backpain)
print(odds_bmi_backpain)
```

Therefore, obese subjects show an odds ratio of `r odds_bmi_backpain` to have back pain.

## ANOVA for `Back Pain` and `Body Weight`

At first, plot again the means as well as create the boxplots.

```{r fig.width=10, fig.height=8}
par(mfrow=c(2,2), oma=c(1,1,2,1), mar=c(2,2,2,2))

plotmeans(ship_valid_backpain$Gewicht ~ ship_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of body fat by back pain", xlab="back pain", ylab="body fat")

boxplot(ship_valid_backpain$Gewicht ~ ship_valid_backpain$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

plotmeans(ship_age_valid_backpain$Gewicht ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, digits=2, ccol="red", mean.labels=T, main="Plot of body fat by back pain", xlab="back pain", ylab="body fat")

boxplot(ship_age_valid_backpain$Gewicht ~ ship_age_valid_backpain$Rueckenschmerz_3Monate, main="back pain by body fat (mean is black dot)", xlab="back pain", ylab="body fat", col=rainbow(7))

title(main = "Top: Age by Body Weight; Bottom: Subjects older than 60 years", outer=TRUE)

summary(aov(formula = Gewicht~Rueckenschmerz_3Monate, data = ship_valid_backpain))
summary(aov(formula = Gewicht~Rueckenschmerz_3Monate, data = ship_age_valid_backpain))
```

The ANOVA rejects the alternative hypothesis.

## Cramérs V for `Back Pain` and `High Blood Pressure`

Since both features are categorical, the statistic of choice is Cramérs V. At first, look at the mosaic plot.

```{r fig.width=10, fig.height=8}
tab_standard <- xtabs(~Blutdruck_hoch + Rueckenschmerz_3Monate, data = ship_valid_backpain)
tab_age <- xtabs(~Blutdruck_hoch + Rueckenschmerz_3Monate, data = ship_age_valid_backpain)
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Blutdruck_hoch="High Blood Pressure", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Blutdruck_hoch="High Blood Pressure (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)

```

`Blood pressure` shows some error markers, which are removed before conducting the Cramérs V analysis.

```{r fig.width=10, fig.height=8}
ship_valid_backpain_bloodpressure <- filter(.data = ship_valid_backpain, Blutdruck_hoch < 900)
ship_age_valid_backpain_bloodpressure <- filter(.data = ship_age_valid_backpain, Blutdruck_hoch < 900)
tab_standard <- xtabs(~Blutdruck_hoch + Rueckenschmerz_3Monate, data = 
ship_valid_backpain_bloodpressure)
tab_age <- xtabs(~Blutdruck_hoch + Rueckenschmerz_3Monate, data = 
ship_age_valid_backpain_bloodpressure)
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Blutdruck_hoch="High Blood Pressure", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Blutdruck_hoch="High Blood Pressure (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)
summary(assocstats(tab_standard))
summary(assocstats(tab_age))
```

Cramérs V is very low and therefore, no correlation can be observed.

## Cramérs V for `Back Pain` and `Alcohol Intake in the last 12 month`

Create a mosaic plot first.

```{r fig.width=10, fig.height=8}
# Create Tabs
tab_standard <- xtabs(~Haeufigkeit_Alkohol_12Monate + Rueckenschmerz_3Monate, data = ship_valid_backpain)
tab_age <- xtabs(~Haeufigkeit_Alkohol_12Monate + Rueckenschmerz_3Monate, data = ship_age_valid_backpain)

# Plot Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Haeufigkeit_Alkohol_12Monate="Alcohol Intake in last 12 Month", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Haeufigkeit_Alkohol_12Monate="Alcohol Intake in last 12 Month (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)
```

Remove the error values

```{r fig.width=10, fig.height=8}
# Filter Subjects
ship_valid_backpain_alcohol <- filter(.data = ship_valid_backpain, Haeufigkeit_Alkohol_12Monate < 900)
ship_age_valid_backpain_alcohol <- filter(.data = ship_age_valid_backpain, Haeufigkeit_Alkohol_12Monate < 900)

# Create Tables
tab_standard <- xtabs(~Haeufigkeit_Alkohol_12Monate + Rueckenschmerz_3Monate, data = ship_valid_backpain_alcohol)
tab_age <- xtabs(~Haeufigkeit_Alkohol_12Monate + Rueckenschmerz_3Monate, data = ship_age_valid_backpain_alcohol)

# Plot Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Haeufigkeit_Alkohol_12Monate="Alcohol Intake in last 12 Month", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Haeufigkeit_Alkohol_12Monate="Alcohol Intake in last 12 Month (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)

# Calculate Correlations
summary(assocstats(tab_standard))
summary(assocstats(tab_age))
```

Again a very low value, no correlation found.

## Cramérs V for `Back Pain` and `Attentiveness Problems`

Create a mosaic plot first.

```{r fig.width=10, fig.height=8}
# Create Tables
tab_standard <- xtabs(~Konzentrationsschwaeche + Rueckenschmerz_3Monate, data = ship_valid_backpain)
tab_age <- xtabs(~Konzentrationsschwaeche + Rueckenschmerz_3Monate, data = ship_age_valid_backpain)

# Plot Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Konzentrationsschwaeche="Attentiveness Disorder", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Konzentrationsschwaeche="Attentiveness Disorder (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)
```

Remove the error values

```{r fig.width=10, fig.height=8}
# Remove the Errors Values
ship_valid_backpain_attentive <- filter(.data = ship_valid_backpain, Konzentrationsschwaeche < 900)
ship_age_valid_backpain_attentive <- filter(.data = ship_age_valid_backpain, Konzentrationsschwaeche < 900)

# Create Tabs
tab_standard <- xtabs(~Konzentrationsschwaeche + Rueckenschmerz_3Monate, data = ship_valid_backpain_attentive)
tab_age <- xtabs(~Konzentrationsschwaeche + Rueckenschmerz_3Monate, data = ship_age_valid_backpain_attentive)

# Create Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Konzentrationsschwaeche="Attentiveness Disorder", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Konzentrationsschwaeche="Attentiveness Disorder (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)

# Calculate Correlations
summary(assocstats(tab_standard))
summary(assocstats(tab_age))
```

The plot actually shows a low relationship of `attentiveness problems` and `back pain`.

## Cramérs V of `Amount of Sleep` and `Back Pain`

First, create the mosaic plot.

```{r fig.width=10, fig.height=8}
# Calculate Tabs
tab_standard <- xtabs(~Hohes_Schlafbeduerfnis + Rueckenschmerz_3Monate, data = ship_valid_backpain)
tab_age <- xtabs(~Hohes_Schlafbeduerfnis + Rueckenschmerz_3Monate, data = ship_age_valid_backpain)

# Plot Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Hohes_Schlafbeduerfnis="High Amount of Sleep", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Hohes_Schlafbeduerfnis="High Amount of Sleep (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)
```

Remove the error values and conduct the analysis.

```{r fig.width=10, fig.height=8}
# Remove Error Values
ship_valid_backpain_sleep <- filter(.data = ship_valid_backpain, Hohes_Schlafbeduerfnis < 900)
ship_age_valid_backpain_sleep <- filter(.data = ship_age_valid_backpain, Hohes_Schlafbeduerfnis < 900)

# Create Tables
tab_standard <- xtabs(~Hohes_Schlafbeduerfnis + Rueckenschmerz_3Monate, data = ship_valid_backpain_sleep)
tab_age <- xtabs(~Hohes_Schlafbeduerfnis + Rueckenschmerz_3Monate, data = ship_age_valid_backpain_sleep)

# Plot Mosaics
mosaic_standard <- grid.grabExpr(mosaic(tab_standard, shade=TRUE, legend=TRUE, set_varnames = list(Hohes_Schlafbeduerfnis="High Amount of Sleep", Rueckenschmerz_3Monate="Back Pain")))
mosaic_age <- grid.grabExpr(mosaic(tab_age, shade=TRUE, legend=TRUE, set_varnames = list(Hohes_Schlafbeduerfnis="High Amount of Sleep (Age > 60 years)", Rueckenschmerz_3Monate="Back Pain (Age > 60 years)")))
grid.arrange(mosaic_standard, mosaic_age, ncol=2)

# Calculate Correlations
summary(assocstats(tab_standard))
summary(assocstats(tab_age))
```